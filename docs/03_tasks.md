# Web-to-Book Reader 開発タスク表 v0.1

本書は「何を、どの順序で、何が終わったら完了か」を明確にするためのタスク表です。チーム開発でも個人開発でも、そのままIssue化できます。

## 0. タスク管理ルール（推奨）
- **優先度**
  - P0: MVP成立に必須（動く/壊れない/データが守られる）
  - P1: UX改善に重要（継続利用に効く）
  - P2: 追加価値（後回し可）
- **状態**
  - Backlog / Ready / In Progress / Review / Done
- **完了条件（DoD）**
  - 仕様/設計に整合
  - エラーケースを考慮
  - 最低限の動作確認（手動でOK、CIは後追い可）

## Phase 0：土台（リポジトリ/運用）
| ID | タスク | 優先度 | 依存 | 工数目安 | 完了条件 |
|---|---|---:|---|---:|---|
| P0-01 | 仕様書/設計書/タスク表の確定（v1） | P0 | - | 0.5d | `docs/` が最新、合意済み |
| P0-02 | 画面/状態管理方針の選定（Query/Store） | P0 | P0-01 | 0.5d | ライブラリ選定・理由が記録 |
| P0-03 | コーディング規約/フォルダ構成案 | P1 | P0-02 | 0.5d | READMEに方針追記 |

## Phase 1：Supabaseセットアップ + シンプルなURL保存/表示
| ID | タスク | 優先度 | 依存 | 工数目安 | 完了条件 |
|---|---|---:|---|---:|---|
| P1-01 | Supabaseプロジェクト作成、ローカル開発環境準備 | P0 | P0-01 | 0.5–1d | ローカルで接続できる |
| P1-02 | DBテーブル作成（`profiles/articles/reading_progress`） | P0 | P1-01 | 0.5–1d | マイグレーションが再現可能 |
| P1-03 | RLS有効化 + ポリシー作成 | P0 | P1-02 | 0.5–1d | 他ユーザーの行が読めない |
| P1-04 | Auth導線（ログイン/ログアウト/セッション保持） | P0 | P1-01 | 0.5–1d | 再起動後もログイン維持 |
| P1-05 | Home（本棚）UI：一覧表示（仮データ→実データ） | P0 | P1-04 | 1–2d | 記事が一覧で見える |
| P1-06 | Add（URL入力）UI：URL登録→DBに保存 | P0 | P1-04,P1-02 | 1d | URLが保存され本棚に出る |
| P1-07 | ステータス更新（未読/読了/アーカイブ） | P0 | P1-06 | 0.5–1d | フィルタで切替できる |
| P1-08 | 共有受け取り（iOS/Android） | P1 | P1-06 | 1–2d | ブラウザ共有から追加できる |

## Phase 2：Edge Functionで本文抽出
| ID | タスク | 優先度 | 依存 | 工数目安 | 完了条件 |
|---|---|---:|---|---:|---|
| P2-01 | 抽出方式決定（方式A/B、状態管理） | P0 | P1-06 | 0.5d | 設計書に反映 |
| P2-02 | Edge Function雛形作成（Deno） | P0 | P2-01 | 0.5d | ローカル/本番で起動確認 |
| P2-03 | fetch安全対策（SSRF/サイズ/タイムアウト/リダイレクト） | P0 | P2-02 | 0.5–1d | 危険URLが拒否される |
| P2-04 | Readabilityで抽出 → `content_json/content_text` 生成 | P0 | P2-03 | 1–2d | 代表サイトで抽出成功 |
| P2-05 | 抽出状態の更新（queued/fetching/succeeded/failed） | P0 | P2-04 | 0.5d | 本棚に状態が反映される |
| P2-06 | 抽出失敗の再試行導線 | P1 | P2-05 | 0.5d | 失敗→再試行→成功が可能 |

## Phase 3：Reader（ページめくりUI）+ 進捗同期
| ID | タスク | 優先度 | 依存 | 工数目安 | 完了条件 |
|---|---|---:|---|---:|---|
| P3-01 | Reader画面骨格（ヘッダ/設定/ページ領域） | P0 | P2-04 | 1d | 抽出済み記事が表示される |
| P3-02 | ページ分割アルゴリズム実装（測定型 or 近似型） | P0 | P3-01 | 2–4d | 横スワイプでページ移動 |
| P3-03 | 読書設定（フォント/行間/テーマ）永続化 | P0 | P3-02 | 1–2d | 変更が次回起動で維持 |
| P3-04 | 進捗保存（ページ遷移/離脱時） | P0 | P3-02,P1-02 | 1d | 再オープンで同ページ復元 |
| P3-05 | 進捗同期（別端末で復元） | P0 | P3-04 | 1–2d | 端末を変えて続きが開く |
| P3-06 | 競合時の扱い（LWW、通知/ジャンプ） | P1 | P3-05 | 0.5–1d | 仕様通りに整合する |

## Phase 4：オフライン対応 + UIブラッシュアップ
| ID | タスク | 優先度 | 依存 | 工数目安 | 完了条件 |
|---|---|---:|---|---:|---|
| P4-01 | ローカルDB導入（SQLite等） | P0 | P3-01 | 1d | 端末に保存できる |
| P4-02 | 記事本文キャッシュ（content_json/content_text） | P0 | P4-01 | 1–2d | 機内モードでも表示できる |
| P4-03 | 進捗オフラインキュー→復帰時同期 | P0 | P4-01,P3-04 | 1–2d | 復帰後に進捗が反映 |
| P4-04 | ページ分割結果キャッシュ（設定/端末依存キー） | P1 | P3-02,P4-01 | 1–2d | 再計算が減る |
| P4-05 | コレクション（フォルダ）UI/DB | P1 | P1-02 | 2–4d | フォルダで整理できる |
| P4-06 | 速度/UX改善（プレースホルダ、骨組み、アニメ） | P2 | P3-02 | 2–5d | 体感が改善したと判断 |

## バックログ（任意）
- 検索（`content_text` を活用）
- タグ、ハイライト、メモ
- TTS（読み上げ）
- 画像のミラーリング（Storage）とオフライン画像
- 共有（抽出結果の共有は著作権的に慎重に）

